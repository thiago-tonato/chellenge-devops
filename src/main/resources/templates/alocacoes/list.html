<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{fragments/_head :: head}"></head>
<body>
<div th:replace="~{fragments/_navbar :: navbar}"></div>

<div style="max-width: 900px; margin: 40px auto;">
    <h1 style="color:#333;">Alocações</h1>

    <div style="text-align:right; margin-bottom:15px;" sec:authorize="hasRole('ADMIN')">
        <a th:href="@{/alocacoes/nova}"
           style="padding:8px 15px; background:#007bff; color:white; border-radius:4px; text-decoration:none;">
            Nova Alocação
        </a>
    </div>

    <table style="width:100%; border-collapse:collapse; background:#fff;">
        <tr style="background:#f0f0f0;">
            <th style="padding:10px;">ID</th>
            <th style="padding:10px;">Moto</th>
            <th style="padding:10px;">Início</th>
            <th style="padding:10px;">Fim</th>
            <th style="padding:10px;">Status</th>
            <th style="padding:10px;" sec:authorize="hasRole('ADMIN')">Ações</th>
        </tr>
        <tr th:each="alocacao : ${alocacoes}" style="border-bottom:1px solid #ddd;">
            <td th:text="${alocacao.id}" style="padding:8px;"></td>
            <td th:text="${alocacao.moto.modelo} + ' - ' + ${alocacao.moto.identificadorUWB}" style="padding:8px;"></td>
            <td th:text="${#temporals.format(alocacao.inicio, 'dd/MM/yyyy HH:mm')}" style="padding:8px;"></td>
            <td th:text="${alocacao.fim != null ? #temporals.format(alocacao.fim, 'dd/MM/yyyy HH:mm') : '-'}" style="padding:8px;"></td>
            <td th:text="${alocacao.status}" style="padding:8px;"></td>
            <td style="padding:8px;" sec:authorize="hasRole('ADMIN')">
                <a th:if="${alocacao.status == T(com.mottu.rastreamento.models.enums.StatusAlocacao).ABERTA}"
                   th:href="@{'/alocacoes/encerrar/' + ${alocacao.id}}"
                   style="color:#dc3545;">Encerrar</a>
            </td>
        </tr>
    </table>
</div>

<div th:replace="~{fragments/_footer :: footer}"></div>
</body>
</html>
